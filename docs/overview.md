# サービス概要（プロダクト概要/設計案）
最終更新: 2025-10-18

本ドキュメントは、日本国内のスマホユーザー向け「共有ボタン/Chrome拡張からメモ・ハイライト・ブックマークを即時に自分専用のLINEトークに集約する」サービス（仮称: ClipLine）の概念設計・技術方針・コスト/リスク・KPIをまとめたものです。

---

## 1. 目的/提供価値
- スマホやPCで発生する「覚えておきたい」を1タップで集約し、後からLINEで取り出せる。
- 読書/自己啓発の“振り返り”を自動で促進し、定着（習慣化）を支援。
- LINEをフロントに据えることで新しいアプリ学習コストをゼロ化。

---

## 2. ターゲット/前提
- 対象: 日本国内スマホユーザー（iOS/Android 両対応）、PCはChrome拡張対応。
- 用途: 晩/仕事後の自己啓発・読書。
- 初期ユーザー規模: 1,000〜10,000人。

---

## 3. 主要機能要件
- 共有機能:
  - スマホ共有シート（iOS Share Extension / Android Share Target）からURL/テキスト/画像の送信。
  - Chrome拡張から選`択テキスト/URL/タイトル/注釈の送信。
- LINE送信:
  - LINE Messaging APIを利用して、ユーザーのLINEトーク（またはグループ）へメモを配信。
  - コスト抑制のため「ユーザー起点（返信）」での配信を基本に設計。
- ユーザー起点の配信フロー:
  - ユーザーが「はい」と返信 → 返信メッセージ（reply）でメモをバッチ配信（1回最大5件）。
  - 件数超過時は「続けて」「もっと」等で追加取得（段階配信）。
- ユーザー起点UI（Quick reply / リッチメニューの message action）
  - ボタン1タップで定型テキスト（例:「はい」「今夜まとめて」）をユーザー発話として送信。
  - サーバはWebhookで受信し、Reply APIで応答（有効期限は約1分、1回最大5メッセージ）。大量配信は段階化（「続けて」等のクイックリプライで誘導）。
  - 課金・上限はPushとは取り扱いが異なる可能性があるため、最新のLINE公式ドキュメントで計数/上限を確認。

---

## 4. 技術構成（スマホ共有 → 受信 → LINE送信）
- モバイルアプリ: React Native + TypeScript
  - iOS: Share Extensionターゲットで text/url/image の受信。App Group経由で本体へ受け渡し。
  - Android: Intent Filter（text/plain, image/*, */*）で受信。
  - セキュア保存: react-native-keychain でAPI鍵/セッションを端末保管。
- PC拡張: Chrome Extension MV3
  - 右クリック/ツールバー/選択テキスト送信、コンテンツスクリプトでメタ情報抽出。
- バックエンド:
  - エッジ/サーバレス（例: Cloudflare Workers or Firebase Functions）
    - 共有ペイロード受信、バリデーション、整形、キュー投入。
  - DB: Postgres系（Supabase等）
    - users, line_links, memos, inbox, deliveries, events を管理。
  - キュー/再試行: Cloud Tasks/Queues でリトライ・レート制御。
  - Webhook: LINE Messaging APIのWebhook受信（ユーザーの「はい」等）。
- LINE連携:
  - 公式アカウント + Messaging API
  - LIFF/ログインでユーザーとLINE User IDを紐付け。

---

## 5. データモデル（例）
- users(id, email, created_at, plan, ...)
- line_links(user_id, line_user_id, status, consented_at)
- memos(id, user_id, source, url, title, quote, note, media, created_at)
- inbox(user_id, memo_id, status[pending|delivered|skipped], queued_at)
- deliveries(id, user_id, memo_id, channel[line-reply|line-push], sent_at, result)
- events(id, user_id, type[share|reply|open|reminder], meta, created_at)

---

## 6. 代表的ユーザーフロー
1) 共有: ユーザーが共有ボタン/拡張から送信 → APIへPOST → inboxへ保存。
2) 通知: 閾値/時間で「未取得メモX件」通知。
3) 取得: ユーザーが「はい」と返信 → reply APIで最大5件配信 → 残数があれば継続案内。
4) 既読/整理: ユーザーはLINE上のクイックリプライでタグ付け/既読処理（任意）。

注: LINEのreplyトークンは有効期限/件数制限（1分/最大5メッセージ）あり。大量配信は段階化。

---

## 7. 仕様/制約（重要）
- LINE Messaging API:
  - Pushメッセージは月額・通数課金の対象。Replyメッセージは仕様変更の可能性があるため、最新の公式ドキュメントで計数/上限を必ず確認。
  - 返信トークンは短時間有効・1コール最大5メッセージ。
  - Quick reply / リッチメニューの message action はユーザー発話起点（ボタン1タップで定型文送出）→ Webhook受信 → Reply API応答（約1分以内/最大5メッセージ）。
  - 画像/ファイル配信はサイズ制約あり。URL配信やサーバ保管リンクを基本にする。
- DRM/コンテンツ方針:
  - Kindle等のDRMコンテンツは自動抽出禁止。ユーザーが明示的に共有した引用・メモのみを取り扱う。
  - 自動クロール/スクレイピングや非公開データの抽出は行わない。
- iOS/Android共有拡張:
  - iOS拡張はメモリ/実行時間が厳格。重処理は本体/サーバに委譲。
  - AndroidはURI権限/大容量添付の取り回しに注意。

---

## 8. UX設計の要点
- 1タップ送信: デフォルト送信先固定、送信後は自動クローズ。
- 自動整形: タイトル/ドメイン/選択テキストから見出し化、重複検知。
- クイックリプライ: 「はい」「スキップ」「タグ:○○」をボタン化。
- 通知最適化: 夜間帯中心、サイレント/上限/頻度設定。
- オフライン耐性: 端末/サーバ両側でキューし、回線復帰で再送。

---

## 9. コスト構造（概算/目安）
- LINE Official Account（Messaging API）
  - 代表的なプラン感: Free/Light/Standard 等。含有通数と月額が設定され、超過は1通あたり約1円前後（プランにより異なる）。
  - 計数や無料/有料区分（push vs reply）は変更され得るため、最新のLINE公式料金ページで要確認。
- サーバ/DB/送信コスト
  - エッジ関数/関数実行: 数百円〜数千円/月（1〜10kユーザー規模の軽負荷想定）。
  - ストレージ/DB: 数百円〜。
  - 画像変換/CDN: 必要に応じて従量。
- 例: 月間アクティブ2,000人、1人あたり未取得通知2回（push）、取得時の配信は返信起点で5通/回、50%が月2回取得
  - 通知（push）: 2,000人×2回×到達率80% ≒ 3,200通 → 超過単価1円の場合≒3,200円
  - 返信配信: 設計上、reply中心（コスト影響は最新仕様に依存）
  - 総額目安: 数千円〜数万円/月（プラン/通数に依存）

---

## 10. マネタイズ（フリーミアム案）
- Free: 月50件送信、検索/タグ一部制限、週次ダイジェストのみ。
- Pro（月¥300〜¥500）: 月500件、全文検索/タグ自動付与、端末間同期高速化、ショートカット/自動化連携。
- Plus（月¥980）: 月無制限に近い上限、要約/抽出のAI補助、エクスポート（Notion/Slack/メール）。
- 追加課金: 上限超過バンドル（+1,000通/¥300 等）。

---

## 11. リスク/競合/差別化
- リスク
  - 返信率低下 → 未取得が滞留し体験低下。
  - LINE仕様変更（課金/上限/ポリシー）。
  - DRM/著作権クレーム。
- 競合
  - メモ/ブックマーク系（Notion/Google Keep/Pocket/LINE Keep等）。
- 差別化
  - 共有シート→LINEに特化した“最短1タップ”体験。
  - 夜の自己啓発シーンに最適化した通知とダイジェスト。
  - 返信起点の段階配信でコスト最適化。

---

## 12. KPI（1〜3年の優先指標）
- DAU/WAU、月間共有回数（送信数/ユーザー）、返信率（「はい」）、未取得滞留率。
- 有料化率、課金継続率（チャーン）、通知オプトアウト率、メモ回遊（再閲覧）率。

---

## 13. セキュリティ/コンプライアンス
- 最小限のデータ収集、暗号化（転送/保存）、アクセス監査。
- 利用規約/プライバシーポリシー整備、著作権・引用範囲の明記。

---

## 14. 実装/運用の当面ロードマップ
- フェーズ1（MVP 2–4週）: 共有→API→inbox→返信配信（最大5件）/未取得通知、Chrome拡張最小版。
- フェーズ2: タグ/検索/重複排除/夜間最適通知、ダイジェスト。
- フェーズ3: Pro/Plus展開、外部連携（Notion/Slack/メール）、分析ダッシュボード。

---

## 15. 補足
- 技術スタック例: React Native（Bare/Config Plugin）, React Query, Supabase/Postgres, Cloudflare Workers, LINE Messaging API, LIFF。
- 料金/仕様は変更され得るため、必ず最新のLINE公式ドキュメントを参照してください。
